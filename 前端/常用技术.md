# 笔记

> 这里记录一下在学习第一个项目期间用到的外部技术

## 1.freemarker

使用这种技术其实就是以**空间换时间**!

![image-20210919212915496](https://gitee.com/miawei/pic-go-img/raw/master/imgs/image-20210919212915496.png)

**解读**:每次在浏览器上访问数据都会发起请求到后端数据库才会返回然后解析,这种一旦数据量庞大那么每次都要去获取数据库那么势必会造成流量相关问题,而可以采取这种模板技术,第一次是从数据库获取而后面的刷新还是第二次请求都是从这个从模板生成好的网页获取,数据都缓存到里面,这样就不会重复去获取数据然后进行重复性的解析!避免造成资源性的浪费!

### 1.1 快速使用

这是一个模板引擎,其作用就是后端通过一个模板去生成对应的网页或者类之类的,

这是maven依赖:

```xml-dtd
<!-- freemarker的坐标依赖 -->
    <dependency>
      <groupId>org.freemarker</groupId>
      <artifactId>freemarker</artifactId>
      <version>2.3.23</version>
    </dependency>
```

这是使用方法:

```java
@Test
    public void test() throws Exception{
        //创建一个Configuration对象,直接new一个对象,构造方法的参数就是freemark对应的版本号
        Configuration configuration = new Configuration(Configuration.VERSION_2_3_23);
        //设置模板文件所在的路径【这里是目录】
        configuration.setDirectoryForTemplateLoading(new File("F:\\源码时代\\frame\\src\\main\\webapp\\static\\templates"));
        //设置模板文件使用的字符集,一般就是urf-8
        configuration.setDefaultEncoding("utf-8");
        //加载一个具体的模板,创建一个模板对象
        Template template = configuration.getTemplate("temp.ftl");
        //创建一个模板使用的数据集,比如map或者Object
        Map<String, Object> map = new HashMap<>();
        //向数据集添加数据
        map.put("title", "喵大威");
        //创建一个Writer对象,一般创建指定文件名称路径
        FileWriter writer = new FileWriter(new File("F:\\源码时代\\frame\\src\\main\\webapp\\static\\templates\\aa.java"));
        //调用模板对象的process方法输出文件
        template.process(map, writer);
        //关闭流
        writer.close();
    }
```

这是对应的目录:

![image-20210919212222124](https://gitee.com/miawei/pic-go-img/raw/master/imgs/image-20210919212222124.png)

结果:

![image-20210919212303667](https://gitee.com/miawei/pic-go-img/raw/master/imgs/image-20210919212303667.png)

可以看出是可以生成的!

### 1.2 模板的语法:

1. 访问map中的key:

   ```js
   ${key}
   ```

2. 访问pojo中的属性

   ```js
   ${key.property}
   ```

3. 取集合中的数据

   ```js
   <#list studentList as student>
    <tr> 
   <td>${student.id}</td>
   <td>${studnet.name}</td>
   </tr>
   </#list>
   ```

4. 取循环中的下标

   ```js
   <#list studentList as student>
       ${student_index}
   </#list>
   ```

5. 判断

   ```js
   <#if student_index % 2 == 0>
   <#else>
   </#if>
   ```

6. 日期类型格式化

   ```js
   <!-- 可以使用?date,?time,?datetime,?string(parten)-->
   当前日期：${date?string("yyyy/MM/dd HH:mm:ss")}
   ```

7. null值的处理

   ```js
   ${val!"val的值为null"}<br>
       判断val的值是否为null：<br>
       <#if val??>
       val中有内容
       <#else>
       val的值为null
       </#if>
   ```

8. Include标签

   ```js
   <#include "hello.ftl">
   ```

### 1.3 踩个坑

今天遇到个坑,就是使用模板生成的静态网页都是乱码的,不论改什么都是乱码,来看一下:

![image-20210920081021686](https://gitee.com/miawei/pic-go-img/raw/master/imgs/image-20210920081021686.png)

最后解决办法就是:

```java
//        FileWriter writer = new FileWriter(new File(file, fileUrlPath));
        OutputStreamWriter writer = new OutputStreamWriter(new FileOutputStream(new File(file, fileUrlPath)), StandardCharsets.UTF_8);
```

将之前输出的文件输出流改为字符转换流,并设置输出格式为UTF-8,这就可以了!

![image-20210920081215557](https://gitee.com/miawei/pic-go-img/raw/master/imgs/image-20210920081215557.png)

